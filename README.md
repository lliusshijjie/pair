# MySTL Pair Implementation

ä¸€ä¸ªç°ä»£åŒ–çš„C++ STLé£æ ¼pairå®ç°ï¼Œæä¾›å®Œæ•´çš„pairå®¹å™¨åŠŸèƒ½ï¼Œæ”¯æŒC++17/20ç‰¹æ€§ï¼Œå¹¶åŒ…å«ç©ºåŸºç±»ä¼˜åŒ–(EBCO)ç­‰æ€§èƒ½ä¼˜åŒ–ã€‚

## é¡¹ç›®ç‰¹æ€§

### ğŸš€ æ ¸å¿ƒç‰¹æ€§
- **å®Œæ•´çš„STLå…¼å®¹æ€§**: ä¸æ ‡å‡†åº“`std::pair`å®Œå…¨å…¼å®¹
- **å¼‚å¸¸å®‰å…¨**: æ‰€æœ‰æ“ä½œéƒ½æä¾›æ­£ç¡®çš„å¼‚å¸¸å®‰å…¨ä¿è¯
- **è§„åˆ™äº”(Rule of Five)**: å®Œæ•´çš„æ‹·è´/ç§»åŠ¨è¯­ä¹‰æ”¯æŒ
- **å§”æ‰˜æ¨¡å¼è®¾è®¡**: ä½¿ç”¨`detail::pair_impl`å¤„ç†å®é™…å­˜å‚¨é€»è¾‘

### ğŸ”§ ç°ä»£C++æ”¯æŒ
- **C++17ç»“æ„åŒ–ç»‘å®š**: æ”¯æŒ`auto [first, second] = pair`è¯­æ³•
- **å®Œç¾è½¬å‘**: ä¿æŒå€¼ç±»åˆ«çš„æ„é€ å‡½æ•°å’Œèµ‹å€¼æ“ä½œ
- **constexpræ”¯æŒ**: ç¼–è¯‘æ—¶è®¡ç®—æ”¯æŒ
- **tupleæ¥å£å…¼å®¹**: æ”¯æŒ`std::get`å’Œtupleç›¸å…³æ“ä½œ

### ğŸ“Š å…¼å®¹æ€§ç‰¹æ€§
- **ä¸std::pairäº’æ“ä½œ**: æ”¯æŒä»`std::pair`æ„é€ å’Œè½¬æ¢
- **ç±»å‹ç‰¹å¾æ”¯æŒ**: å®Œæ•´çš„ç±»å‹ç‰¹å¾æ£€æŸ¥
- **æ¯”è¾ƒæ“ä½œç¬¦**: å®Œæ•´çš„å­—å…¸åºæ¯”è¾ƒæ”¯æŒ

## é¡¹ç›®ç»“æ„

```
pair/
â”œâ”€â”€ include/
â”‚   â””â”€â”€ my_stl/
â”‚       â”œâ”€â”€ pair.hpp          # ä¸»è¦çš„pairç±»æ¥å£
â”‚       â”œâ”€â”€ utility.hpp       # å·¥å…·å‡½æ•°(make_pair, swapç­‰)
â”‚       â””â”€â”€ detail/           # å®ç°ç»†èŠ‚ç›®å½•
â”œâ”€â”€ test/
â”‚   â”œâ”€â”€ unit/                 # å•å…ƒæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_pair_basic.cpp
â”‚   â”‚   â”œâ”€â”€ test_pair_compatibility.cpp
â”‚   â”‚   â”œâ”€â”€ test_pair_ebco.cpp
â”‚   â”‚   â””â”€â”€ test_pair_performance.cpp
â”‚   â”œâ”€â”€ integration/          # é›†æˆæµ‹è¯•
â”‚   â”‚   â””â”€â”€ test_with_std.cpp
â”‚   â””â”€â”€ benchmark/            # æ€§èƒ½æµ‹è¯•
â”‚       â””â”€â”€ benchmark_pair.cpp
â”œâ”€â”€ CMakeLists.txt           # æ„å»ºé…ç½®
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

## å¿«é€Ÿå¼€å§‹

### åŸºæœ¬ä½¿ç”¨

```cpp
#include "my_stl/utility.hpp"
#include <iostream>

int main() {
    // å€¼æ„é€ 
    my_stl::pair<int, std::string> p1(42, "hello");
    
    // CTADæ”¯æŒ (C++17)
    my_stl::pair p2(3.14, "world");
    
    // make_pairå‡½æ•°
    auto p3 = my_stl::make_pair(1, 2.0);
    
    // ç»“æ„åŒ–ç»‘å®š (C++17)
    auto [first, second] = p1;
    std::cout << first << ", " << second << std::endl;
    
    return 0;
}
```

### æ¯”è¾ƒæ“ä½œ

```cpp
my_stl::pair<int, int> a(1, 2);
my_stl::pair<int, int> b(1, 3);

// å­—å…¸åºæ¯”è¾ƒ
if (a < b) {
    std::cout << "a < b" << std::endl;
}

// ä¸std::pairäº’æ“ä½œ
std::pair<int, int> c(1, 2);
if (a == c) {
    std::cout << "a == c" << std::endl;
}
```

### ä¸std::pairäº’æ“ä½œç¤ºä¾‹

```cpp
// ä»std::pairæ„é€ 
std::pair<int, std::string> std_pair(42, "hello");
my_stl::pair<int, std::string> my_pair(std_pair);

// è½¬æ¢ä¸ºstd::pair
my_stl::pair<int, std::string> my_pair2(24, "world");
std::pair<int, std::string> std_pair2 = my_pair2;

// æ¯”è¾ƒæ“ä½œ
if (my_pair == std_pair) {
    std::cout << "Pairs are equal" << std::endl;
}
```

## æ„å»ºå’Œæµ‹è¯•

### æ„å»ºé¡¹ç›®

```bash
# åˆ›å»ºæ„å»ºç›®å½•
mkdir build && cd build

# é…ç½®é¡¹ç›®
cmake ..

# æ„å»º
cmake --build .
```

### è¿è¡Œæµ‹è¯•

```bash
# å¯ç”¨æµ‹è¯•
cmake -DBUILD_TESTING=ON ..

# æ„å»ºå¹¶è¿è¡Œæµ‹è¯•
cmake --build .
ctest
```

### è¿è¡Œç‰¹å®šæµ‹è¯•

```bash
# è¿è¡ŒåŸºæœ¬åŠŸèƒ½æµ‹è¯•
./test/unit/test_pair_basic

# è¿è¡Œå…¼å®¹æ€§æµ‹è¯•
./test/unit/test_pair_compatibility

# è¿è¡Œæ€§èƒ½æµ‹è¯•
./test/unit/test_pair_performance
```

## APIå‚è€ƒ

### ä¸»è¦ç±»

#### `my_stl::pair<T1, T2>`

**æˆå‘˜ç±»å‹:**
- `first_type`: ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç±»å‹
- `second_type`: ç¬¬äºŒä¸ªå…ƒç´ çš„ç±»å‹

**æˆå‘˜å˜é‡:**
- `first`: ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨
- `second`: ç¬¬äºŒä¸ªå…ƒç´ çš„å¼•ç”¨

**æ„é€ å‡½æ•°:**
- é»˜è®¤æ„é€ ã€å€¼æ„é€ ã€æ‹·è´æ„é€ ã€ç§»åŠ¨æ„é€ 
- å®Œç¾è½¬å‘æ„é€ ã€ä»å…¶ä»–pairç±»å‹æ„é€ 
- ä»`std::pair`æ„é€ 

**èµ‹å€¼æ“ä½œ:**
- æ‹·è´èµ‹å€¼ã€ç§»åŠ¨èµ‹å€¼
- ä»å…¶ä»–pairç±»å‹èµ‹å€¼
- ä»`std::pair`èµ‹å€¼

### å·¥å…·å‡½æ•°

#### `my_stl::make_pair(T1&& t1, T2&& t2)`
åˆ›å»ºpairå¯¹è±¡ï¼Œè‡ªåŠ¨æ¨å¯¼ç±»å‹ã€‚

#### `my_stl::swap(pair<T1, T2>& lhs, pair<T1, T2>& rhs)`
äº¤æ¢ä¸¤ä¸ªpairå¯¹è±¡çš„å†…å®¹ã€‚

### æ¯”è¾ƒæ“ä½œç¬¦

æ”¯æŒæ‰€æœ‰æ ‡å‡†æ¯”è¾ƒæ“ä½œç¬¦ï¼š`==`, `!=`, `<`, `<=`, `>`, `>=`

### ç»“æ„åŒ–ç»‘å®šæ”¯æŒ

æ”¯æŒC++17ç»“æ„åŒ–ç»‘å®šï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨`auto [first, second] = pair`è¯­æ³•ã€‚

## æŠ€æœ¯ç»†èŠ‚

### å®ç°æ¶æ„

é¡¹ç›®é‡‡ç”¨å§”æ‰˜æ¨¡å¼è®¾è®¡ï¼Œpairç±»ä¸»è¦æä¾›æ¥å£å’Œè½¬å‘é€»è¾‘ï¼Œå®é™…çš„å­˜å‚¨å’Œé€»è¾‘å¤„ç†ç”±åº•å±‚å®ç°è´Ÿè´£ã€‚

### å¼‚å¸¸å®‰å…¨ä¿è¯

- **åŸºæœ¬ä¿è¯**: æ‰€æœ‰æ“ä½œåœ¨å¼‚å¸¸å‘ç”Ÿæ—¶ä¿æŒå¯¹è±¡æœ‰æ•ˆæ€§
- **å¼ºä¿è¯**: èµ‹å€¼æ“ä½œç­‰æä¾›å¼ºå¼‚å¸¸å®‰å…¨ä¿è¯
- **æ— å¼‚å¸¸ä¿è¯**: ç§»åŠ¨æ“ä½œç­‰æä¾›æ— å¼‚å¸¸ä¿è¯

### ç±»å‹ç‰¹å¾æ”¯æŒ

é¡¹ç›®åŒ…å«å®Œæ•´çš„ç±»å‹ç‰¹å¾å·¥å…·ï¼Œæ”¯æŒï¼š
- å¼‚å¸¸å®‰å…¨æ£€æŸ¥
- ç§»åŠ¨è¯­ä¹‰æ”¯æŒæ£€æŸ¥
- SFINAEå‹å¥½æ¥å£
- tupleæ¥å£å…¼å®¹æ€§æ£€æŸ¥

## å…¼å®¹æ€§

- **C++æ ‡å‡†**: C++14åŠä»¥ä¸Šï¼ˆC++17æ¨èï¼‰
- **ç¼–è¯‘å™¨**: GCC 7+, Clang 5+, MSVC 2017+
- **æ ‡å‡†åº“**: ä¸ä»»ä½•ç¬¦åˆæ ‡å‡†çš„STLå®ç°å…¼å®¹
- **æµ‹è¯•æ¡†æ¶**: ä½¿ç”¨Catch2è¿›è¡Œå•å…ƒæµ‹è¯•ï¼ŒGoogle Benchmarkè¿›è¡Œæ€§èƒ½æµ‹è¯•

## æµ‹è¯•è¦†ç›–

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼š

- **åŸºæœ¬åŠŸèƒ½æµ‹è¯•**: æ„é€ ã€èµ‹å€¼ã€æ¯”è¾ƒç­‰åŸºæœ¬æ“ä½œ
- **å…¼å®¹æ€§æµ‹è¯•**: ä¸std::pairçš„äº’æ“ä½œæ€§
- **æ€§èƒ½æµ‹è¯•**: æ€§èƒ½åŸºå‡†æµ‹è¯•
- **é›†æˆæµ‹è¯•**: ä¸æ ‡å‡†åº“çš„é›†æˆæµ‹è¯•

### è¿è¡Œæµ‹è¯•

æ‰€æœ‰æµ‹è¯•éƒ½å¯ä»¥é€šè¿‡CMakeé…ç½®å’Œè¿è¡Œï¼Œç¡®ä¿ä»£ç è´¨é‡å’ŒåŠŸèƒ½æ­£ç¡®æ€§ã€‚

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ã€‚è¯¦è§LICENSEæ–‡ä»¶ã€‚

## ç›¸å…³èµ„æº

- [C++æ ‡å‡†æ–‡æ¡£](https://isocpp.org/)
- [STLå‚è€ƒ](https://en.cppreference.com/w/cpp/utility/pair)
- [EBCOæŠ€æœ¯è¯´æ˜](https://en.wikipedia.org/wiki/Empty_base_optimization)

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ•™è‚²æ€§è´¨çš„STLå®ç°ï¼Œé€‚ç”¨äºå­¦ä¹ å’Œç ”ç©¶ç›®çš„ã€‚ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨æ ‡å‡†åº“å®ç°ã€‚